#A collection of Python scripts to do basic operations on a multi-fasta file
#1. How many records in the multi-fasta? 
#2. What are the lengths of the sequences in the multi-fasta? (Makes a dictionary with keys=sequence names, values=lengths; also makes a dictionary of values=sequences)

#1. HOW MANY RECORDS IN THE MULTI-FASTA?
#open the fasta file
sequence = open("./dna.example.fasta", "r")
#make a list
number_list = []
#iterate over each line of the sequence
for line in sequence:
#find each line that starts with > 
    if line[0] == ">":
#add those lines to the list
        number_list.append(str(line))
#print the length of the list (# records in fasta)
print("The number of records in the FASTA file is:", len(number_list))
#close the fasta file
sequence.close()


#2. WHAT ARE THE LENGTHS OF THE SEQUENCES IN THE MULTI-FASTA?
#open the fasta file
sequence = open("./dna.example.fasta", "r")
sequence_read = sequence.read()
#make some empty lists and dictionaries
keys = []
keys2 = []
values = []
values2 = []
lengths = []
#split the multi-fasta at each occurrance of ">"
sequence_list = sequence_read.split(">")
#find the end of the description section for each sequence
for record in sequence_list[1:]:
    end = record.find("\n")
    end1 = end + 1
#add the descriptions to the keys list and the sequences to the values list
    keys.append(record[0:end1])
    values.append(record[end1:])
#remove the newlines
for eachkey in keys:
    keys2.append(eachkey.replace("\n", ""))
for eachvalue in values:
    values2.append(eachvalue.replace("\n", ""))
#make a dictionary with the keys and values
sequence_dict = dict(zip(keys2, values2))
#make a list with the sequence lengths
for eachvalue in values2:
    lengths.append(len(eachvalue))  
#make a dictionary with the keys and sequence lengths
length_dict = dict(zip(keys2, lengths))
#sort dictionary by length
length_dict_sorted = sorted(length_dict.items(), key = lambda x:x[1], reverse=False)
#print the sequence descriptors and sequence lengths (in size order from shortest to longest)
for i in length_dict_sorted:
    print(i[0], i[1])
#close the fasta file
sequence.close()
